<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Selecci√≥n de Paraescolar</title>
<link rel="stylesheet" href="/style.css">
<style>
body {
  font-family: Arial, sans-serif;
}

.container {
  max-width: 700px;
  margin: auto;
  padding: 20px;
}

input, select, button {
  width: 100%;
  padding: 8px;
  margin-bottom: 10px;
}

fieldset {
  margin-top: 15px;
}

.locked {
  background-color: #eee;
}
</style>
</head>

<body>

<div class="container">

<h2>Registro de Paraescolar</h2>

<form id="registroForm">

<!-- üîç BUSCADOR -->
<div>
  <input type="text" id="numero_control" placeholder="Ingresa tu N√∫mero de Control" required>
  <button type="button" onclick="buscarAlumno()">Buscar</button>
</div>

<!-- üìã DATOS DEL ALUMNO -->
<fieldset>
  <legend>Datos del Alumno</legend>

  <input id="curp" placeholder="CURP" readonly>
  <input id="nombre" placeholder="Nombre Completo" readonly>
  <input id="grado" placeholder="Grado" readonly>
  <input id="grupo" placeholder="Grupo" readonly>

</fieldset>

<!-- üéØ PARAESCOLAR -->
<fieldset>
  <legend>Selecciona Paraescolar</legend>

  <select id="paraescolar" required>
    <option value="">-- Selecciona --</option>
    <option value="AJEDREZ">AJEDREZ</option>
    <option value="ATLETISMO">ATLETISMO</option>
    <option value="BANDA DE GUERRA">BANDA DE GUERRA</option>
    <option value="BASQUETBOL">BASQUETBOL</option>
    <option value="DANZA">DANZA</option>
    <option value="ESCOLTA DE BANDERA">ESCOLTA DE BANDERA</option>
    <option value="FOTOGRAF√çA">FOTOGRAF√çA</option>
    <option value="FUTBOL">FUTBOL</option>
    <option value="PINTURA">PINTURA</option>
    <option value="TEATRO-CANTO">TEATRO-CANTO</option>
    <option value="TOCHO BANDERA">TOCHO BANDERA</option>
    <option value="VOLEIBOL">VOLEIBOL</option>
    <option value="ORATORIA Y DECLAMACI√ìN">ORATORIA Y DECLAMACI√ìN</option>
    <option value="M√öSICA">M√öSICA</option>
  </select>

</fieldset>

<button type="submit">Guardar Paraescolar</button>

</form>

</div>

<script>
let alumno = null;

// üîç Buscar alumno
async function buscarAlumno() {
  const control = document.getElementById("numero_control").value.trim();
  if (!control) return alert("Ingresa el n√∫mero de control");

  try {
    const resp = await fetch(`/api/paraescolar/${control}`);
    const data = await resp.json();

    if (data.error) {
      alert("Alumno no encontrado");
      limpiar();
      return;
    }

    alumno = data;

    // Mostrar datos
    curp.value   = data.curp || "";
    nombre.value = data.nombre || "";
    grado.value  = data.grado || "";
    grupo.value  = data.grupo || "";

    // Si ya est√° bloqueado
    if (data.bloqueado) {
      paraescolar.value = data.paraescolar;
      paraescolar.disabled = true;
      alert("‚ö†Ô∏è Este alumno ya tiene paraescolar asignado.");
    } else {
      paraescolar.disabled = false;
    }

  } cat
